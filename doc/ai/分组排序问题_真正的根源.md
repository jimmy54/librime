# åˆ†ç»„æ’åºé—®é¢˜ï¼šä¸ºä»€ä¹ˆ"åº­"è¿˜æ˜¯æ²¡æœ‰æ’ç¬¬ä¸€ï¼Ÿ

## ğŸ¯ å…³é”®å‘ç°

**é…ç½®å·²ç”Ÿæ•ˆ**ï¼š
- âœ… `non_collocation_penalty: -18`ï¼ˆå·²åº”ç”¨ï¼‰
- âœ… `collocation_penalty: -6`ï¼ˆå·²åº”ç”¨ï¼‰

**ä½†é—®é¢˜ä¾ç„¶å­˜åœ¨**ï¼š
- âŒ "å¬"ä»ç„¶æ’ç¬¬ä¸€
- âŒ "åº­"ä»ç„¶æ’ç¬¬äºŒ

**çœŸæ­£çš„åŸå› **ï¼š**åˆ†ç»„æ’åºæœºåˆ¶**ï¼

---

## ğŸ“Š æœ€æ–°æ—¥å¿—åˆ†æ

### å¬çš„è¯„åˆ†ï¼ˆå·²æ”¹å–„ï¼‰

```
I20251017 01:56:00.957353 script_translator.cc:594] user phrase 'å¬', code length: 1
I20251017 01:56:00.957414 octagram.cc:159] context = å®¶, word = å¬ / -18
I20251017 01:56:00.957418 contextual_translation.cc:46] contextual suggestion: å¬ weight: -24.7521
```

**è§£è¯»**ï¼š
- ç±»å‹ï¼š`user_phrase`ï¼ˆç”¨æˆ·è¯ç»„ï¼‰
- ä¸Šä¸‹æ–‡è¯„åˆ†ï¼š`-18`ï¼ˆå·²ä» `-12` æ”¹ä¸º `-18`ï¼‰âœ…
- **æœ€ç»ˆæƒé‡ï¼š`-24.7521`**

---

### åº­çš„è¯„åˆ†ï¼ˆå·²æ”¹å–„ï¼‰

```
I20251017 01:56:00.959187 script_translator.cc:608] phrase 'åº­', code length: 1
I20251017 01:56:00.959227 octagram.cc:144] update: å®¶[1] + åº­[1] = 5.357
I20251017 01:56:00.959233 octagram.cc:159] context = å®¶, word = åº­ / 5.357
I20251017 01:56:00.959236 contextual_translation.cc:46] contextual suggestion: åº­ weight: -6.48027
```

**è§£è¯»**ï¼š
- ç±»å‹ï¼š`phrase`ï¼ˆç³»ç»Ÿè¯ç»„ï¼‰
- ä¸Šä¸‹æ–‡è¯„åˆ†ï¼š`5.357`ï¼ˆå·²ä» `-0.643` æ”¹ä¸º `5.357`ï¼‰âœ…
- **æœ€ç»ˆæƒé‡ï¼š`-6.48027`**

---

## ğŸ”‘ æƒé‡å¯¹æ¯”ï¼ˆé…ç½®å·²ç”Ÿæ•ˆï¼‰

| å€™é€‰ | ç±»å‹ | è¯å…¸æƒé‡ | ä¸Šä¸‹æ–‡è¯„åˆ† | æœ€ç»ˆæƒé‡ | æ’å |
|------|------|---------|-----------|---------|------|
| å¬ | user_phrase | -6.7521 | -18.0 | -24.7521 | ? |
| **åº­** | **phrase** | **-11.8373** | **+5.357** | **-6.48027** | **?** |

**è®¡ç®—éªŒè¯**ï¼š
```
å¬: -6.7521 + (-18.0) = -24.7521
åº­: -11.8373 + 5.357 = -6.48027  â† æƒé‡æ›´é«˜ï¼âœ…
```

**ç»“è®º**ï¼šä»æƒé‡æ¥çœ‹ï¼Œ"åº­"ï¼ˆ`-6.48`ï¼‰åº”è¯¥æ’åœ¨"å¬"ï¼ˆ`-24.75`ï¼‰å‰é¢ï¼

---

## ğŸ¤” ä¸ºä»€ä¹ˆ"åº­"è¿˜æ˜¯æ²¡æœ‰æ’ç¬¬ä¸€ï¼Ÿ

### é—®é¢˜æ ¹æºï¼šåˆ†ç»„æ’åºæœºåˆ¶

æŸ¥çœ‹ `contextual_translation.cc` çš„ä»£ç ï¼š

```cpp
// contextual_translation.cc L11-38
bool ContextualTranslation::Replenish() {
  vector<of<Phrase>> queue;
  size_t end_pos = 0;
  std::string last_type;  // â† å…³é”®ï¼šæŒ‰ç±»å‹åˆ†ç»„
  
  while (!translation_->exhausted() &&
         cache_.size() + queue.size() < kContextualSearchLimit) {
    auto cand = translation_->Peek();
    
    if (cand->type() == "phrase" || cand->type() == "user_phrase" || ...) {
      // â­ å…³é”®åˆ¤æ–­ï¼šæŒ‰ç»“æŸä½ç½® AND ç±»å‹åˆ†ç»„
      if (end_pos != cand->end() || last_type != cand->type()) {
        end_pos = cand->end();
        last_type = cand->type();
        AppendToCache(queue);  // â† æ’åºå½“å‰ç»„
      }
      queue.push_back(Evaluate(As<Phrase>(cand)));
    }
  }
  AppendToCache(queue);
  return !cache_.empty();
}
```

**å…³é”®é€»è¾‘**ï¼š
```cpp
if (end_pos != cand->end() || last_type != cand->type()) {
  AppendToCache(queue);  // æ’åºå¹¶æ·»åŠ åˆ°ç¼“å­˜
}
```

**åˆ†ç»„æ¡ä»¶**ï¼š
1. ç»“æŸä½ç½®ç›¸åŒï¼ˆ`end_pos == cand->end()`ï¼‰
2. **ç±»å‹ç›¸åŒ**ï¼ˆ`last_type == cand->type()`ï¼‰

**åªæœ‰åŒæ—¶æ»¡è¶³è¿™ä¸¤ä¸ªæ¡ä»¶ï¼Œå€™é€‰æ‰ä¼šåœ¨åŒä¸€ç»„å†…æ’åºï¼**

---

## ğŸ“‹ å®é™…æ‰§è¡Œæµç¨‹

### å€™é€‰å‡ºç°é¡ºåº

```
1. å¬ (user_phrase, end=1, weight=-24.7521)
   â†“
   ç±»å‹: user_phrase
   ç»“æŸä½ç½®: 1
   â†’ åŠ å…¥ queue[0]
   
2. ä»– (phrase, end=1, weight=-23.6385)
   â†“
   ç±»å‹: phrase â‰  user_phrase  â† ç±»å‹ä¸åŒï¼
   ç»“æŸä½ç½®: 1
   â†’ â­ è§¦å‘åˆ†ç»„ï¼šæ’åº queue[0]ï¼Œæ·»åŠ åˆ° cache
   â†’ åˆ›å»ºæ–° queue[1]
   
3. å¤´ (phrase, end=1, weight=...)
   â†“
   ç±»å‹: phrase = phrase  â† ç±»å‹ç›¸åŒ
   ç»“æŸä½ç½®: 1
   â†’ åŠ å…¥ queue[1]
   
...

30. åº­ (phrase, end=1, weight=-6.48027)
    â†“
    ç±»å‹: phrase = phrase  â† ç±»å‹ç›¸åŒ
    ç»“æŸä½ç½®: 1
    â†’ åŠ å…¥ queue[1]
    
31. è°ˆ (phrase, end=1, weight=...)
    â†“
    è¾¾åˆ° 32 ä¸ªå€™é€‰é™åˆ¶
    â†’ â­ è§¦å‘åˆ†ç»„ï¼šæ’åº queue[1]ï¼Œæ·»åŠ åˆ° cache
```

---

### åˆ†ç»„ç»“æœ

```
ç»„1 (user_phrase):
  1. å¬ (-24.7521)  â† åªæœ‰è¿™ä¸€ä¸ª

ç»„2 (phrase):
  1. åº­ (-6.48027)  â† æœ€ä¼˜
  2. ä»– (-23.6385)
  3. å¤´ (...)
  ...
```

---

### æœ€ç»ˆå€™é€‰åˆ—è¡¨

```
cache = [
  å¬ (-24.7521),  â† ç»„1çš„ç¬¬ä¸€ä¸ªï¼ˆuser_phraseï¼‰
  åº­ (-6.48027),  â† ç»„2çš„ç¬¬ä¸€ä¸ªï¼ˆphraseï¼‰
  ä»– (-23.6385),  â† ç»„2çš„ç¬¬äºŒä¸ª
  å¤´ (...),       â† ç»„2çš„ç¬¬ä¸‰ä¸ª
  ...
]
```

**ç»“æœ**ï¼š
- âœ… ç»„å†…æ’åºæ­£ç¡®ï¼ˆ"åº­"åœ¨ phrase ç»„å†…æ’ç¬¬ä¸€ï¼‰
- âŒ ä½†"å¬"ä½œä¸º user_phrase ç»„çš„å”¯ä¸€æˆå‘˜ï¼Œå…ˆè¢«æ·»åŠ åˆ° cache
- âŒ æ‰€ä»¥"å¬"æ’åœ¨"åº­"å‰é¢

---

## ğŸ’¡ ä¸ºä»€ä¹ˆè¦è¿™æ ·è®¾è®¡ï¼Ÿ

### è®¾è®¡ç†å¿µ

ContextualTranslation çš„åˆ†ç»„æ’åºæ˜¯ä¸ºäº†ï¼š

1. **ä¿æŒå€™é€‰ç±»å‹çš„ç¨³å®šæ€§**
   - user_phrase ä¼˜å…ˆäº phrase
   - ç”¨æˆ·è¯ç»„åº”è¯¥ä¼˜å…ˆæ˜¾ç¤º

2. **é¿å…å…¨å±€æ’åºçš„æ€§èƒ½å¼€é”€**
   - åªåœ¨ç»„å†…æ’åºï¼ˆå°èŒƒå›´ï¼‰
   - ä¸è·¨ç»„æ’åºï¼ˆé¿å…æ‰“ä¹±åŸæœ‰é¡ºåºï¼‰

3. **å°Šé‡åŸå§‹ Translator çš„æ’åº**
   - Translator å·²ç»æŒ‰ç±»å‹æ’åº
   - ContextualTranslation åªåšå¾®è°ƒ

---

### ç±»å‹ä¼˜å…ˆçº§

```
user_phrase  (ç”¨æˆ·è¯ç»„)
    â†“
phrase       (ç³»ç»Ÿè¯ç»„)
    â†“
user_table   (ç”¨æˆ·è¡¨è¯)
    â†“
table        (ç³»ç»Ÿè¡¨è¯)
    â†“
completion   (è¡¥å…¨)
```

**"å¬"æ˜¯ user_phraseï¼Œ"åº­"æ˜¯ phraseï¼Œæ‰€ä»¥"å¬"ä¼˜å…ˆï¼**

---

## ğŸ› ï¸ è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ1ï¼šè®©"åº­"ä¹Ÿæˆä¸º user_phraseï¼ˆæ¨èï¼‰

æ‰‹åŠ¨æ·»åŠ "åº­"åˆ°ç”¨æˆ·è¯å…¸ï¼š

```bash
cd /Users/jimmy54/Pictures/jimmy_librime/librime/cmake-build-debug/bin

# æ–¹æ³•1ï¼šé€šè¿‡è¾“å…¥æ³•æ·»åŠ 
# è¾“å…¥ "ting"ï¼Œé€‰æ‹© "åº­"ï¼Œå¤šæ¬¡ä½¿ç”¨
# ç”¨æˆ·è¯å…¸ä¼šè‡ªåŠ¨å­¦ä¹ 

# æ–¹æ³•2ï¼šæ‰‹åŠ¨ç¼–è¾‘ç”¨æˆ·è¯å…¸
# ç¼–è¾‘ user_profile/wanxiang.userdb.txt
# æ·»åŠ : åº­	ting	1000

# é‡æ–°éƒ¨ç½²
./rime_deployer --build user_profile
```

**æ•ˆæœ**ï¼š
```
ç»„1 (user_phrase):
  1. åº­ (-6.48027)  â† æœ€ä¼˜ï¼Œæ’ç¬¬ä¸€ âœ…
  2. å¬ (-24.7521)
```

---

### æ–¹æ¡ˆ2ï¼šä¿®æ”¹ ContextualTranslationï¼Œå–æ¶ˆç±»å‹åˆ†ç»„

ä¿®æ”¹ `contextual_translation.cc`ï¼š

```cpp
// ä¿®æ”¹å‰ï¼ˆæŒ‰ç±»å‹åˆ†ç»„ï¼‰
if (end_pos != cand->end() || last_type != cand->type()) {
  AppendToCache(queue);
}

// ä¿®æ”¹åï¼ˆåªæŒ‰ä½ç½®åˆ†ç»„ï¼‰
if (end_pos != cand->end()) {
  AppendToCache(queue);
}
```

**æ•ˆæœ**ï¼š
- âœ… æ‰€æœ‰ç›¸åŒç»“æŸä½ç½®çš„å€™é€‰åœ¨åŒä¸€ç»„
- âœ… "åº­"å’Œ"å¬"ä¼šåœ¨åŒä¸€ç»„å†…æ’åº
- âœ… "åº­"ï¼ˆ`-6.48`ï¼‰ä¼šæ’åœ¨"å¬"ï¼ˆ`-24.75`ï¼‰å‰é¢

**å‰¯ä½œç”¨**ï¼š
- âŒ æ‰“ç ´äº†ç±»å‹ä¼˜å…ˆçº§
- âŒ å¯èƒ½å½±å“å…¶ä»–åœºæ™¯çš„æ’åº

---

### æ–¹æ¡ˆ3ï¼šå¢åŠ ç”¨æˆ·è¯å…¸çš„ä¸Šä¸‹æ–‡è¯„åˆ†æƒé‡

ä¿®æ”¹ `grammar.h`ï¼Œä¸º user_phrase ä¹Ÿåº”ç”¨ä¸Šä¸‹æ–‡è¯„åˆ†ï¼š

```cpp
// grammar.h
inline static double Evaluate(const string& context,
                              const string& entry_text,
                              double entry_weight,
                              bool is_rear,
                              Grammar* grammar,
                              bool is_user_phrase = false) {  // æ–°å¢å‚æ•°
  const double kPenalty = -18.420680743952367;
  
  double context_score = grammar ? grammar->Query(context, entry_text, is_rear) 
                                 : kPenalty;
  
  // â­ å¦‚æœæ˜¯ç”¨æˆ·è¯ç»„ï¼Œå¢å¤§ä¸Šä¸‹æ–‡è¯„åˆ†çš„æƒé‡
  if (is_user_phrase && context_score < 0) {
    context_score *= 2.0;  // æƒ©ç½šåŠ å€
  }
  
  return entry_weight + context_score;
}
```

**æ•ˆæœ**ï¼š
```
å¬ (user_phrase):
  è¯å…¸æƒé‡: -6.7521
  ä¸Šä¸‹æ–‡è¯„åˆ†: -18.0 * 2.0 = -36.0  â† æƒ©ç½šåŠ å€
  æœ€ç»ˆæƒé‡: -6.7521 + (-36.0) = -42.7521

åº­ (phrase):
  è¯å…¸æƒé‡: -11.8373
  ä¸Šä¸‹æ–‡è¯„åˆ†: 5.357
  æœ€ç»ˆæƒé‡: -11.8373 + 5.357 = -6.48027  â† æ’ç¬¬ä¸€ âœ…
```

---

### æ–¹æ¡ˆ4ï¼šä½¿ç”¨ ContextualRankingFilter å…¨å±€é‡æ’

åœ¨ Filter å±‚è¿›è¡Œå…¨å±€æ’åºï¼Œä¸å—åˆ†ç»„é™åˆ¶ï¼š

```cpp
// contextual_ranking_filter.cc
class ContextualRankingFilter : public Filter {
  an<Translation> Apply(an<Translation> translation, ...) override {
    // æ”¶é›†æ‰€æœ‰å€™é€‰ï¼ˆä¸åˆ†ç»„ï¼‰
    vector<pair<Candidate, double>> all_candidates;
    
    while (!translation->exhausted() && all_candidates.size() < 100) {
      auto cand = translation->Peek();
      double score = EvaluateWithContext(cand);
      all_candidates.push_back({cand, score});
      translation->Next();
    }
    
    // â­ å…¨å±€æ’åºï¼ˆä¸è€ƒè™‘ç±»å‹ï¼‰
    std::sort(all_candidates.begin(), all_candidates.end(),
              [](auto& a, auto& b) { return a.second > b.second; });
    
    return MakeTranslation(all_candidates);
  }
};
```

**æ•ˆæœ**ï¼š
- âœ… å®Œå…¨æŒ‰ä¸Šä¸‹æ–‡è¯„åˆ†æ’åº
- âœ… ä¸å—ç±»å‹é™åˆ¶
- âœ… "åº­"ä¼šæ’ç¬¬ä¸€

---

## ğŸ“Š æ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ | éš¾åº¦ | æ•ˆæœ | å‰¯ä½œç”¨ | æ¨èåº¦ |
|------|------|------|--------|--------|
| **æ–¹æ¡ˆ1ï¼šæ·»åŠ åˆ°ç”¨æˆ·è¯å…¸** | ç®€å• | å¥½ | æ—  | â­â­â­â­â­ |
| **æ–¹æ¡ˆ2ï¼šä¿®æ”¹åˆ†ç»„é€»è¾‘** | ä¸­ç­‰ | å¾ˆå¥½ | å¯èƒ½å½±å“å…¶ä»–åœºæ™¯ | â­â­â­ |
| **æ–¹æ¡ˆ3ï¼šå¢åŠ æƒ©ç½šæƒé‡** | ä¸­ç­‰ | å¥½ | éœ€è¦ä¿®æ”¹ä»£ç  | â­â­â­â­ |
| **æ–¹æ¡ˆ4ï¼šå…¨å±€é‡æ’** | å¤æ‚ | æœ€å¥½ | æ€§èƒ½å¼€é”€ | â­â­â­â­ |

---

## ğŸ¯ æ¨èæ–¹æ¡ˆ

### çŸ­æœŸæ–¹æ¡ˆï¼ˆç«‹å³è§æ•ˆï¼‰

**æ–¹æ¡ˆ1ï¼šè®©"åº­"æˆä¸º user_phrase**

```bash
# æ–¹æ³•1ï¼šå¤šæ¬¡ä½¿ç”¨"åº­"ï¼Œè®©ç”¨æˆ·è¯å…¸å­¦ä¹ 
# è¾“å…¥ "ting"ï¼Œé€‰æ‹© "åº­"ï¼Œé‡å¤10æ¬¡

# æ–¹æ³•2ï¼šæ‰‹åŠ¨æ·»åŠ 
echo "åº­	ting	1000" >> user_profile/wanxiang.userdb.txt
./rime_deployer --build user_profile
```

---

### é•¿æœŸæ–¹æ¡ˆï¼ˆæœ€ä½³ï¼‰

**æ–¹æ¡ˆ3 + æ–¹æ¡ˆ4ï¼šä¿®æ”¹ä»£ç  + æ·»åŠ  Filter**

1. **ä¿®æ”¹ ContextualTranslation**ï¼Œå–æ¶ˆç±»å‹åˆ†ç»„ï¼š
   ```cpp
   // contextual_translation.cc L23
   if (end_pos != cand->end()) {  // åˆ é™¤ || last_type != cand->type()
     AppendToCache(queue);
   }
   ```

2. **æ·»åŠ  ContextualRankingFilter**ï¼Œå…¨å±€é‡æ’ï¼š
   ```yaml
   # wanxiang.schema.yaml
   engine:
     filters:
       - contextual_ranking_filter
   ```

---

## ğŸ“‹ éªŒè¯æ­¥éª¤

### æ–¹æ¡ˆ1ï¼šæ·»åŠ åˆ°ç”¨æˆ·è¯å…¸

```bash
# 1. å¤šæ¬¡ä½¿ç”¨"åº­"
./rime_console
# è¾“å…¥ "jia" é€‰æ‹© "å®¶"
# è¾“å…¥ "ting" é€‰æ‹© "åº­"
# é‡å¤10æ¬¡

# 2. æŸ¥çœ‹ç”¨æˆ·è¯å…¸
cat user_profile/wanxiang.userdb.txt | grep "åº­"

# 3. é‡æ–°æµ‹è¯•
# è¾“å…¥ "jia" é€‰æ‹© "å®¶"
# è¾“å…¥ "ting"
# æŸ¥çœ‹å€™é€‰åˆ—è¡¨
```

**æœŸæœ›ç»“æœ**ï¼š
```
1. [åº­]  â† æ’ç¬¬ä¸€ï¼ˆuser_phraseï¼‰âœ…
2.  å¬
3.  æŒº
```

---

### æ–¹æ¡ˆ2ï¼šä¿®æ”¹åˆ†ç»„é€»è¾‘

```cpp
// src/rime/gear/contextual_translation.cc L23
// ä¿®æ”¹å‰
if (end_pos != cand->end() || last_type != cand->type()) {

// ä¿®æ”¹å
if (end_pos != cand->end()) {
```

é‡æ–°ç¼–è¯‘ï¼š
```bash
cd /Users/jimmy54/Pictures/jimmy_librime/librime
make
make install
```

æµ‹è¯•ï¼š
```bash
./rime_console
# è¾“å…¥ "jia" é€‰æ‹© "å®¶"
# è¾“å…¥ "ting"
```

**æœŸæœ›ç»“æœ**ï¼š
```
1. [åº­]  â† æ’ç¬¬ä¸€ âœ…
2.  å¬
3.  æŒº
```

---

## ğŸ” æ—¥å¿—éªŒè¯

æŸ¥çœ‹æ—¥å¿—ç¡®è®¤åˆ†ç»„ï¼š

```bash
tail -f user_profile/log/rime.console.*.log | grep "appending to cache"
```

**ä¿®æ”¹å‰**ï¼ˆæŒ‰ç±»å‹åˆ†ç»„ï¼‰ï¼š
```
appending to cache 1 candidates.   â† ç»„1: user_phrase (å¬)
appending to cache 31 candidates.  â† ç»„2: phrase (åº­, ä»–, å¤´, ...)
```

**ä¿®æ”¹å**ï¼ˆåªæŒ‰ä½ç½®åˆ†ç»„ï¼‰ï¼š
```
appending to cache 32 candidates.  â† åªæœ‰ä¸€ç»„ (åº­, å¬, ä»–, å¤´, ...)
```

---

## ğŸ¯ æ€»ç»“

### é—®é¢˜æ ¹æº

1. âœ… é…ç½®å·²ç”Ÿæ•ˆï¼ˆ`non_collocation_penalty: -18`ï¼‰
2. âœ… æƒé‡è®¡ç®—æ­£ç¡®ï¼ˆ"åº­" `-6.48` > "å¬" `-24.75`ï¼‰
3. âŒ **åˆ†ç»„æ’åºæœºåˆ¶å¯¼è‡´é—®é¢˜**
   - "å¬"æ˜¯ `user_phrase`
   - "åº­"æ˜¯ `phrase`
   - æŒ‰ç±»å‹åˆ†ç»„ï¼Œuser_phrase ä¼˜å…ˆ

### è§£å†³æ–¹æ³•

**æ¨èæ–¹æ¡ˆ**ï¼šè®©"åº­"ä¹Ÿæˆä¸º user_phrase

```bash
# å¤šæ¬¡ä½¿ç”¨"åº­"ï¼Œè®©ç”¨æˆ·è¯å…¸å­¦ä¹ 
# æˆ–æ‰‹åŠ¨æ·»åŠ åˆ°ç”¨æˆ·è¯å…¸
echo "åº­	ting	1000" >> user_profile/wanxiang.userdb.txt
./rime_deployer --build user_profile
```

**æœ€ä½³æ–¹æ¡ˆ**ï¼šä¿®æ”¹ä»£ç ï¼Œå–æ¶ˆç±»å‹åˆ†ç»„

```cpp
// contextual_translation.cc L23
if (end_pos != cand->end()) {  // åˆ é™¤ç±»å‹åˆ¤æ–­
  AppendToCache(queue);
}
```

### å…³é”®æ•™è®­

**ContextualTranslation çš„åˆ†ç»„æ’åºæœºåˆ¶**ï¼š
- æŒ‰ç»“æŸä½ç½® **AND** ç±»å‹åˆ†ç»„
- åªåœ¨ç»„å†…æ’åºï¼Œä¸è·¨ç»„æ’åº
- user_phrase ä¼˜å…ˆäº phrase
- è¿™æ˜¯ä¸ºäº†ä¿æŒç±»å‹ä¼˜å…ˆçº§å’Œæ€§èƒ½

**ä½ çš„ ContextualRankingFilter å¯ä»¥é¿å…è¿™ä¸ªé—®é¢˜**ï¼š
- å…¨å±€æ’åºï¼Œä¸åˆ†ç»„
- å®Œå…¨æŒ‰ä¸Šä¸‹æ–‡è¯„åˆ†æ’åº
- æ›´çµæ´»ï¼Œæ›´å¯æ§
